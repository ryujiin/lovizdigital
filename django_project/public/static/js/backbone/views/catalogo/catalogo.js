define(["jquery","underscore","backbone","../../collections/productos","productosTotal","../../views/catalogo/productoLista","../../views/app/bloque_ajax","../../collections/catalogo/filtros"],function(t,o,i,e,l,c,n,r){"use strict";var s=i.View.extend({id:"",className:"",collection:new e,events:{},initialize:function(){this.listenTo(r,"add",this.filtrar),this.listenTo(r,"remove",this.filtrar)},render:function(){this.collection.forEach(this.addOne,this);var t=l;t.add([this.collection])},addOne:function(t){t.set({visible:!0});var o=new c({model:t});this.$el.append(o.$el),o.$el.addClass("col-md-4")},buscar_productos:function(){var o=this,i=new n;this.collection.fetch({data:t.param({categoria:this.slug})}).always(function(){o.render(),o.ver_filtros(),i.remove()})},ver_filtros:function(){r.length>0&&this.filtrar()},filtrar:function(){var t=r;if(t.length>0){this.collection.forEach(function(t){t.set("visible",!1)});var o=this;t.forEach(function(t){"color"===t.toJSON().tipo&&o.filtrar_color(t.toJSON().valor)})}else this.collection.forEach(function(t){t.set("visible",!0)})},filtrar_color:function(t){this.collection.where({color:t}).forEach(function(t){t.set("visible",!0)})}});return s});