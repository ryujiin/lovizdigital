define(["jquery","underscore","backbone","swig","carro"],function(t,e,i,r,o){"use strict";var a=i.View.extend({template:r.compile(t("#add_to_cart_tlp").html()),tagName:"form",id:"",className:"addtocart",events:{"click #addtocart":"verificar_compra"},initialize:function(){this.render(),this.listenTo(this.model,"change",this.render)},render:function(){this.$el.html(this.template(this.model.toJSON()))},verificar_compra:function(){var e=o,i=this,r=this.model.toJSON().carro;r?this.comprar():e.save().done(function(e){t.localStorage.set({carro:e.id}),i.model.set({carro:e.id}),i.comprar()})},comprar:function(){this.model;o.id&&(this.model.set({cantidad:1}),this.model.save().done(function(){o.fetch()}))}});return a});