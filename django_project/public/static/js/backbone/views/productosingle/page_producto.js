define(["jquery","underscore","backbone","swig","../../models/productos","../../collections/productos","../../collections/comentarios","productosTotal","../../views/app/breadcrumb","../../views/productosingle/galeria_full","../../views/productosingle/galeria_mobil","../../views/productosingle/add_to_cart","../../models/linea","../../views/productosingle/relacionados","../../views/productosingle/estrellas","../../views/productosingle/seccion_comentarios","../../views/productosingle/nuevo_comentario","../../views/app/header","../../models/comentario","carro"],function(e,o,t,i,a,l,s,r,d,n,c,m,h,u,_,p,g,v,b,f){"use strict";var w=t.View.extend({el:e("#contenido"),template:i.compile(e("#productoSingles_tlp").html()),tagName:"div",id:"",className:"",collection:new l,events:{"click .tallas_elegibles .en_stock":"cambiar_talla","click #agregar_alCarro":"comprar_producto"},initialize:function(){this.listenTo(this.model,"change",this.render)},render:function(){this.$el.html(this.template(this.model.toJSON())),this.change_header(),this.add_bread(),this.add_galleria(),this.add_button_cart(),this.add_relacionados(),this.add_estrellas(),this.add_lista_comentarios()},change_header:function(){var e=this.model.toJSON().full_name+" | Loviz DelCarpioÂ® :: lovizdc.com",o=this.model.toJSON().descripcion,t=v;t.render(e,o)},cambiar_producto:function(o){var t=r,i=this;if(o!==this.model.toJSON().slug){var a=t.findWhere({slug:o});a?this.model.set(a.toJSON()):this.collection.fetch({data:e.param({slug:o})}).done(function(e){t.add(this.collection),i.model.set(e[0])})}else this.render()},add_bread:function(){this.breadVista=new d({el:e(".nav-breadcrumb")}),this.breadVista.collection.reset();var o=this.model.toJSON(),t={nombre:"Home",link:"/"};this.breadVista.collection.add(t);var i=this.model.toJSON().categorias;i&&(i.forEach(this.agregar_bread,this),t={nombre:o.nombre,link:null},this.breadVista.collection.add(t),this.breadVista.render())},agregar_bread:function(e){var o={nombre:e.nombre,link:e.link};this.breadVista.collection.add(o)},add_galleria:function(){new n({model:this.model,el:e(this.$("#galeria_full"))}),new c({model:this.model,el:e(this.$("#galeria_movil"))})},cambiar_talla:function(o){this.$(".tallas_elegibles .talla_seleccion").removeClass("seleccionado");var t=o.target.dataset.valor;this.$(".precios .precio_variacion.mostrar").removeClass("mostrar"),this.$(".precios .precio_variacion."+t).addClass("mostrar"),e(o.target).addClass("seleccionado"),this.lineamodel.set({variacion:t})},add_button_cart:function(){this.lineamodel=new h({producto:this.model.id,carro:f.id}),this.buttonAddCart=new m({model:this.lineamodel,el:this.$("#addtocart")})},add_relacionados:function(){var e,o=new u({el:this.$("#producto-asociado .lista-productos")}),t=this.model.toJSON().categorias;t.forEach(function(o){"categoria"===o.seccion&&(e=o.slug)}),o.buscar_productos(e)},add_estrellas:function(){var e=new _({el:this.$(".estrellas"),model:this.model});e.render(this.model.toJSON().valoracion)},add_lista_comentarios:function(){{var e=new s;new p({el:this.$("#recomendation-producto"),model:this.model,collection:e}),new g({el:this.$("#nuevo_comentario"),model:new b,collection:e})}},comprar_producto:function(){this.buttonAddCart.verificar_compra(this)}}),N=new a;return new w({model:N})});